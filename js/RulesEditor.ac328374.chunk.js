(this["webpackJsonpcheckout-prism-merchant-ui"]=this["webpackJsonpcheckout-prism-merchant-ui"]||[]).push([[12],{1230:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return $}));var r=n(1),a=n(7),i=n(0),c=n(496),o=n(2),s=n(6),l=n(8),u=n(543),b=n(5),d=n(620),g=n(466),f=n(598),p=n(214),j=n(101);function h(){const e=Object(l.a)(["\n  font-size: 14px;\n  color: ",";\n"]);return h=function(){return e},e}function O(){const e=Object(l.a)(["\n  font-family: OCR A Extended;\n  justify-self: end;\n  font-size: 12px;\n  ",";\n"]);return O=function(){return e},e}function x(){const e=Object(l.a)(["\n  font-size: 14px;\n  background-color: #fff;\n  cursor: pointer;\n  list-style: none;\n  padding: 12px 8px;\n  ",";\n"]);return x=function(){return e},e}function m(){const e=Object(l.a)(["\n        color: ",";\n      "]);return m=function(){return e},e}function v(){const e=Object(l.a)(["\n        color: ",";\n      "]);return v=function(){return e},e}function C(){const e=Object(l.a)(["\n    background-color: transparent;\n  "]);return C=function(){return e},e}function w(){const e=Object(l.a)(["\n      background-color: ",";\n      color: ",";\n    "]);return w=function(){return e},e}const k=Object(b.default)(o.ListItem)(x(),(({isHighlighted:e,theme:t})=>e?Object(b.css)(w(),t.colors.success,t.colors.white):Object(b.css)(C()))),I=Object(b.default)(o.Box)(O(),(e=>e.isHighlighted?e.theme.colors.white:((e,t)=>{switch(e){case"string":return Object(b.css)(v(),t.colors.success);case"number":return Object(b.css)(m(),t.colors.warning)}})(e.type,e.theme))),E=Object(b.default)(o.Text)(h(),(({isHighlighted:e,theme:t})=>e?t.colors.white:t.colors.base)),y=e=>void 0!==e.type;var S=({item:e,index:t})=>{const n=Object(o.useMenuContext)(),a=n.getItemProps,i=n.highlightedIndex===t,c=y(e)?e.type:e.alias,l=y(e)?e.type:"";return Object(r.jsxs)(k,Object(s.a)(Object(s.a)({},a({key:e.name,index:t,item:e})),{},{isHighlighted:i,children:[Object(r.jsxs)(j.a,{gridTemplateColumns:"auto auto",children:[Object(r.jsx)(o.Box,{pr:3,children:e.name}),Object(r.jsx)(I,{type:l,isHighlighted:i,children:c})]}),Object(r.jsx)(E,{isHighlighted:i,mt:2,fontSize:"12px",children:e.description})]}))};function L(){const e=Object(l.a)(["\n  box-shadow: rgba(121, 131, 149, 0.15) 0px 1px 3px 0px;\n  border: 1px solid rgb(223, 231, 235);\n  top: ","px;\n  left: ","px;\n  position: absolute;\n  z-index: 10000;\n  background: white;\n  max-height: 300px;\n  box-shadow: rgba(121, 131, 149, 0.15) 0px 1px 3px 0px;\n  overflow-y: scroll;\n  max-width: 400px;\n  min-width: 300px;\n"]);return L=function(){return e},e}const T=Object(b.default)(o.List)(L(),(e=>e.top),(e=>e.left));var H=Object(i.memo)((e=>{let t=Object.assign({},e);const n=Object(o.useMenuContext)(),a=n.ref,i=n.getMenuProps;return Object(r.jsx)("div",Object(s.a)(Object(s.a)({ref:a,"data-testid":"menu-list"},i()),{},{children:Object(r.jsx)(T,Object(s.a)({},t))}))}));var z=({properties:e,position:t})=>{const n=Object(a.a)(t,2),i=n[0],c=n[1];return Object(r.jsx)(p.a,{children:Object(r.jsx)(H,{top:i,left:c,children:e.map(((e,t)=>Object(r.jsx)(S,{item:e,index:t,itemToString:e=>e.name},e.name)))})})},M=n(12),R=n(511);function A(){const e=Object(l.a)(["\n    overflow: auto;\n    padding: 8px 12px;\n    line-height: 2em;\n    border: 1px solid\n      ",";\n    border-radius: ",";\n    box-shadow: ",";\n    :focus {\n      box-shadow: 0 0 0 4px rgba(13, 165, 220, 0.5),\n        0 2px 5px 0 rgba(27, 47, 55, 0.25);\n    }\n\n    ","\n  "]);return A=function(){return e},e}const P=Object(b.default)(f.a)((({theme:e,hasErrors:t})=>Object(b.css)(A(),t?e.colors.danger:e.colors.baseLight,e.radii[1],e.shadows.focusLight[0],M.minHeight)));var B=({autoCompleteItems:e,initialValue:t,name:n,editor:l,autoCompleteTarget:b,onChange:f,renderLeaf:p,hasErrors:j})=>{const h=Object(i.useState)([{children:[{text:t}]}]),O=Object(a.a)(h,2),x=O[0],m=O[1],v=Object(i.useState)([0,0]),C=Object(a.a)(v,2),w=C[0],k=C[1],I=Object(o.useMenuContext)(),E=I.getInputProps,y=I.isOpen,S=I.toggleMenu,L=I.clearSelection,T=Object(g.d)(),H=T.setFieldValue,M=T.getFieldProps,A=Object(R.b)().readOnly;Object(i.useEffect)((()=>{if(b&&e.length>0){const e=u.b.toDOMRange(l,b).getBoundingClientRect();k([e.bottom+window.pageYOffset+10,e.left+window.pageXOffset]),S({isOpen:!0})}else S({isOpen:!1})}),[l,b,e.length,S]);const B=Object(i.useCallback)((e=>{m(e),H(n,e.map((e=>c.c.string(e))).join("\n")),f(),L()}),[L,n,f,H]);return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)(u.c,{editor:l,value:x,onChange:B,children:[Object(r.jsx)(P,Object(s.a)(Object(s.a)(Object(s.a)({readOnly:A,spellCheck:"false","data-testid":"rules-editor",tokensToSkip:["OTHERS","WHITESPACE"],tokenize:d.a,hasErrors:j,renderElement:e=>{const t=e.attributes,n=e.children;return Object(r.jsx)("p",Object(s.a)(Object(s.a)({},t),{},{children:n}))},renderLeaf:p},M(n)),y?E():{}),{},{minHeight:["200px","200px","200px","350px"]})),y&&Object(r.jsx)(z,{properties:e,position:w})]})})};var V=(e,t)=>{const n=Object(i.useState)(""),r=Object(a.a)(n,2),o=r[0],s=r[1],l=Object(i.useState)(null),u=Object(a.a)(l,2),b=u[0],d=u[1],g=Object(i.useCallback)((n=>{const r=c.a.before(e,n,{unit:"offset",distance:2}),a=r&&c.a.range(e,r,n),i=a&&c.a.string(e,a),o=(e=>new RegExp("\\B".concat(e.prefix,"$")))(t),s=null===i||void 0===i?void 0:i.match(o);if(!s)return null;const l=c.a.before(e,n,{unit:"offset",distance:s[0].length});return{point:l,range:l&&c.a.range(e,l,n),input:s[1]}}),[t,e]),f=Object(i.useCallback)((n=>{const r=c.a.after(e,n,{unit:"offset",distance:2}),a=r&&c.a.range(e,n,r),i=a&&c.a.string(e,a),o=t.suffix&&(e=>new RegExp("^".concat(e.suffix,"\\B")))(t),s=o&&(null===i||void 0===i?void 0:i.match(o));if(!s)return null;const l=c.a.after(e,n,{unit:"offset",distance:s[0].length});return{point:l,range:l&&c.a.range(e,n,l),input:s[1]}}),[t,e]),p=Object(i.useCallback)((n=>{const r=c.a.before(e,n,{unit:"line"}),a=r&&c.a.range(e,r,n),i=a&&c.a.string(e,a),o=(e=>new RegExp("".concat(e.prefix,"([a-zA-Z_0-9]+)$")))(t),s=null===i||void 0===i?void 0:i.match(o);if(!s)return null;const l=c.a.before(e,n,{unit:"offset",distance:s[0].length});return{point:l,range:l&&c.a.range(e,l,n),input:s[1]}}),[t,e]),j=Object(i.useCallback)((n=>{const r=c.a.after(e,n,{unit:"line"}),a=r&&c.a.range(e,n,r),i=a&&c.a.string(e,a),o=(e=>new RegExp("^([a-zA-Z_0-9]*)".concat(e.suffix)))(t),s=null===i||void 0===i?void 0:i.match(/^([a-zA-Z_0-9]*\b)/),l=t.suffix&&(null===i||void 0===i?void 0:i.match(o)),u=null!==l&&void 0!==l?l:s;if(!u)return null;const b=c.a.after(e,n,{unit:"offset",distance:u[0].length});return{point:b,range:b&&c.a.range(e,n,b),input:u[1]}}),[t,e]);return{handleChange:Object(i.useCallback)((()=>{s(""),d(null);const t=e.selection;if(t&&c.g.isCollapsed(t)){const u=c.g.edges(t),b=Object(a.a)(u,1)[0],h=g(b),O=f(b),x=p(b),m=j(b);var n;if(h&&!O)d(null!==(n=h.range)&&void 0!==n?n:null),s("");else if(h&&O){const t=h.range&&O.range&&c.a.range(e,h.range,O.range);d(null!==t&&void 0!==t?t:null),s("")}else if(x&&!m){var r,i;d(null!==(r=x.range)&&void 0!==r?r:null),s(null!==(i=x.input)&&void 0!==i?i:"")}else if(x&&m){var o,l;const t=x.range&&m.range&&c.a.range(e,x.range,m.range);d(null!==t&&void 0!==t?t:null),s((null!==(o=x.input)&&void 0!==o?o:"")+(null!==(l=m.input)&&void 0!==l?l:""))}}}),[e,j,p,f,g]),target:b,searchInput:o}},F=n(619),Z=n(516);const _=(e,t,n)=>{var r;c.i.insertText(e,"".concat(n.prefix).concat(t).concat(null!==(r=n.suffix)&&void 0!==r?r:"")),c.i.insertText(e," "),c.i.move(e)},J=e=>void 0!==e.alias;var $=({name:e,initialValue:t,submitAndTestCount:n})=>{var s;const l=Object(Z.b)(),u=l.availableProperties,b=l.availableLists,d=Object(R.b)().editor,f=V(d,{prefix:"@"}),p=V(d,{prefix:":",suffix:":"}),j=Object(g.c)(e),h=Object(a.a)(j,2)[1],O=n>0&&void 0!==h.error,x=Object(i.useCallback)(((e,t,n)=>e.filter((e=>e[n].toLowerCase().includes(t.toLowerCase())))),[]),m=Object(i.useMemo)((()=>p.target?null!==p.searchInput?x(u,p.searchInput,"name"):u:f.target?null!==f.searchInput?x(b,f.searchInput,"alias"):b:[]),[b,u,x,f.searchInput,f.target,p.searchInput,p.target]),v=Object(F.a)().getLeafRenderer,C=Object(i.useMemo)((()=>v(u)),[u,v]);return Object(r.jsx)(o.SelectMenu,{initialSelectedItem:u[0],onChange:e=>{p.target&&e&&!J(e)&&(c.i.select(d,p.target),_(d,e.name,{prefix:":",suffix:":"})),f.target&&e&&J(e)&&(c.i.select(d,f.target),_(d,e.alias,{prefix:"@"}))},children:Object(r.jsx)(B,{renderLeaf:C,onChange:()=>{p.handleChange(),f.handleChange()},autoCompleteTarget:null!==(s=p.target)&&void 0!==s?s:f.target,autoCompleteItems:m,name:e,initialValue:t,editor:d,hasErrors:O})})}}}]);
//# sourceMappingURL=RulesEditor.ac328374.chunk.js.map